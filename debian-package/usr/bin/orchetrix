#!/bin/bash

# Orchetrix launcher script - Self-contained PyInstaller version
APP_DIR="/opt/orchetrix"

# Set library path for the bundled application
export LD_LIBRARY_PATH="$APP_DIR/_internal:$LD_LIBRARY_PATH"

# Ensure icon symlink exists for runtime
if [ -d "$APP_DIR/_internal/Icons" ] && [ ! -d "$APP_DIR/Icons" ]; then
    ln -sf "$APP_DIR/_internal/Icons" "$APP_DIR/Icons" 2>/dev/null || true
fi

# Check if PyInstaller version exists
if [ -f "$APP_DIR/Orchetrix" ]; then
    # Run PyInstaller binary
    cd "$APP_DIR"
    exec "./Orchetrix" "$@"
else
    echo "Error: Orchetrix installation not found at $APP_DIR/Orchetrix"
    echo "Please reinstall the package."
    exit 1
fi
